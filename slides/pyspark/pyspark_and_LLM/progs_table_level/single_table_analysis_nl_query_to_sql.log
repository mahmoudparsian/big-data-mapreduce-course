% ~/spark-4.0.0/bin/spark-submit read_csv_and_nl_query_to_sql.py data.csv

csv_filename= data.csv

=== Sample Data ===
+-------+---+-----------+------+
|name   |age|department |salary|
+-------+---+-----------+------+
|Alice  |30 |Engineering|100000|
|Bob    |35 |HR         |80000 |
|Charlie|25 |Engineering|70000 |
|Diana  |40 |Marketing  |90000 |
|Evan   |38 |HR         |85000 |
|Fay    |28 |Marketing  |95000 |
|George |45 |Engineering|110000|
|Helen  |33 |HR         |78000 |
+-------+---+-----------+------+


=== 🔍 GPT-Generated SQL ===
sql_query= ```sql
SELECT department, AVG(salary) as avg_salary
FROM employees
WHERE age > 30
GROUP BY department
ORDER BY avg_salary DESC
LIMIT 1
```

=== ✅ Query Result ===
+-----------+----------+
|department |avg_salary|
+-----------+----------+
|Engineering|110000.0  |
+-----------+----------+
